server {
  listen __ADMIN_PORT__;
  listen [::]:__ADMIN_PORT__;
  server_name _;
  root __APP_DIR__;
  index index.html;

  # gro√üe Uploads zulassen (muss zu PHP post_max_size passen)
  client_max_body_size 256m;

  add_header X-Content-Type-Options nosniff always;
  add_header X-Frame-Options SAMEORIGIN always;
  add_header Referrer-Policy no-referrer-when-downgrade always;
  add_header X-Served-By signage-admin always;

  auth_basic "Restricted";
  auth_basic_user_file __AUTH_FILE__;

  location = / { return 302 /admin/; }
  location = /admin { return 302 /admin/; }
  location /admin/ {
    try_files $uri $uri/ /admin/index.html;
  }

  location = /favicon.ico { access_log off; log_not_found off; return 204; }

  location ~ ^/admin/api/.*\.php$ {
    include snippets/fastcgi-php.conf;
    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
    fastcgi_pass unix:__PHP_SOCK__;
  }
location ^~ /data/ {
  add_header Cache-Control "no-store, must-revalidate" always;
  auth_basic off;                       # WICHTIG: ohne Login
  try_files $uri =404;
}
include /etc/nginx/snippets/signage-pairing.conf;
}
